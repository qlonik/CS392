h[k_, a_, b_] := (b - a) / (2^(k - 1));
R[1, 1, a_, b_] := (b - a) / 2 * (f[a] + f[b]);
R[k_, 1, a_, b_] := (R[k - 1, 1, a, b] + h[k - 1, a, b] *
    Sum[f[a + (2 * i - 1) * h[k, a, b]], {i, 1, 2^(k - 2)}]) / 2;
R[k_, j_, a_, b_] := R[k, j - 1, a, b] +
    (R[k, j - 1, a, b] - R[k - 1, j - 1, a, b]) / (4^(j - 1) - 1);
